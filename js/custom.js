var percentFlag=!1;function essayScroll(){const e=(document.documentElement.scrollTop||window.pageYOffset)%document.documentElement.clientHeight;result<=99||(result=99),!percentFlag&&e+100>=document.documentElement.clientHeight&&document.querySelector("#waterfall")?setTimeout((()=>{waterfall("#waterfall")}),500):setTimeout((()=>{document.querySelector("#waterfall")&&waterfall("#waterfall")}),500);const t=window.scrollY+document.documentElement.clientHeight;let n=document.getElementById("post-comment")||document.getElementById("footer");(n.offsetTop+n.offsetHeight/2<t||90<result)&&(percentFlag=!0)}function replaceAll(e,t,n){return e.split(t).join(n)}var icat={diffDate:function(e,t=!1){const n=new Date,l=new Date(e),o=n.getTime()-l.getTime(),r=36e5,a=24*r;let i;if(t){const e=o/a,t=o/r,n=o/6e4;i=o/2592e6>=1?l.toLocaleDateString().replace(/\//g,"-"):e>=1?parseInt(e)+" "+GLOBAL_CONFIG.date_suffix.day:t>=1?parseInt(t)+" "+GLOBAL_CONFIG.date_suffix.hour:n>=1?parseInt(n)+" "+GLOBAL_CONFIG.date_suffix.min:GLOBAL_CONFIG.date_suffix.just}else i=parseInt(o/a);return i},changeTimeInEssay:function(){document.querySelector("#bber")&&document.querySelectorAll("#bber time").forEach((function(e){var t=e,n=t.getAttribute("datetime");t.innerText=icat.diffDate(n,!0),t.style.display="inline"}))},reflashEssayWaterFall:function(){document.querySelector("#waterfall")&&setTimeout((function(){waterfall("#waterfall"),document.getElementById("waterfall").classList.add("show")}),500)},commentText:function(e){"undefined"!=e&&"null"!=e||(e="好棒！");var t=document.getElementsByClassName("el-textarea__inner")[0],n=document.createEvent("HTMLEvents");if(t){n.initEvent("input",!0,!0);var l=replaceAll(e,"\n","\n> ");t.value="> "+l+"\n\n",t.dispatchEvent(n);var o=document.querySelector("#post-comment").offsetTop;window.scrollTo(0,o-80),t.focus(),t.setSelectionRange(-1,-1),document.getElementById("comment-tips")&&document.getElementById("comment-tips").classList.add("show")}}};function waterfall(e){function t(e,t){var n=window.getComputedStyle(t);return parseFloat(n["margin"+e])||0}function n(e){return e+"px"}function l(e){return parseFloat(e.style.left)}function o(e){return e.clientWidth}function r(e){return function(e){return parseFloat(e.style.top)}(e)+function(e){return e.clientHeight}(e)+t("Bottom",e)}function a(e){return l(e)+o(e)+t("Right",e)}function i(e){e=e.sort((function(e,t){return r(e)===r(t)?l(t)-l(e):r(t)-r(e)}))}function c(t){o(e)!=g&&(t.target.removeEventListener(t.type,arguments.callee),waterfall(e))}"string"==typeof e&&(e=document.querySelector(e));var s=[].map.call(e.children,(function(e){return e.style.position="absolute",e}));e.style.position="relative";var u=[];s.length&&(s[0].style.top="0px",s[0].style.left=n(t("Left",s[0])),u.push(s[0]));for(var f=1;f<s.length;f++){var m=s[f-1],d=s[f];if(!(a(m)+o(d)<=o(e)))break;d.style.top=m.style.top,d.style.left=n(a(m)+t("Left",d)),u.push(d)}for(;f<s.length;f++){i(u);d=s[f];var p=u.pop();d.style.top=n(r(p)+t("Top",d)),d.style.left=n(l(p)),u.push(d)}i(u);var y=u[0];e.style.height=n(r(y)+t("Bottom",y));var g=o(e);window.addEventListener?window.addEventListener("resize",c):document.body.onresize=c}icat.changeTimeInEssay(),icat.reflashEssayWaterFall();